---
title: "Uso do R nos Levantamentos Geoqu√≠micos"
author: "Viviane Carillo Ferrari"
subtitle: "DIGEOQ"
title-slide-attributes:
  data-background-image: "images/fundo_azul.png"
  data-background-opacity: "0.5"
format: 
  revealjs:
    logo: "images/logo.png"
    width: 1600
    height: 900
    self-contained: true
    incremental: false
    footer: "C√≥digo dos slides [on GitHub](https://github.com/VivianeCF/R4geoch.git)."
    theme: ["custom.scss"]
    slide-number: c/t
    show-slide-number: all
    hash-type: number
    preview-links: false
    code-line-numbers: false
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE)
 #set to two decimal 
require(magrittr)

```

## Introdu√ß√£o

\
\
Sejam bem vindos, estou muito contente pelo interesse de voc√™s. üòç\
\
A apresenta√ß√£o de hoje aborda uma introdu√ß√£o √† linguagem R e sua aplica√ß√£o na √°rea da geoqu√≠mica. O fluxo de trabalho escolhido abrange as tarefas iniciais de um projeto de levantamento geoqu√≠mico desenvolvido no SGB.\
\
Utilizo como exemplo os dados do levantamento da folha Eldorado Paulista levantada em 2008.

## Objetivos

A proposta aqui √© mostrar um caminho mais f√°cil de usar as ferramentas do R, disponibilizadas na forma de um pacote do R voltado para a comunidade de geoqu√≠micos.\
\
Para testar esta forma de uso do R criei o pacote [`digeoqR`](https://github.com/VivianeCF/digeoqR.git), ele j√° reune algumas funcionalidades muito interessantes. No futuro pretendo adicionar mais fun√ß√µes voltadas ao tratamento dos dados.\
\
Aqui tento lan√ßar uma semente para os futuros colaboradores deste ou de outros pacotes. Espero tornar o R uma ferramenta de apoio aos trabalhos dos geoqu√≠micos do SGB-CPRM.\

## Conte√∫do

1.  Introdu√ß√£o a linguagem R

2.  Uso do R no levantamento geoqu√≠mico

3.  Fechamento

## 1. Introdu√ß√£o a linguagem R

::: columns
::: {.column width="50%" style="font-size: 40px"}
1.  [O que √© R?](#r)

    -   Hist√≥ria do R

    -   Por que usar R?

    -   CRAN

2.  [Instala√ß√£o e estrutura](#instalacao-e-estrutura)

    -   Instala√ß√£o

    -   Sess√£o

    -   Vers√µes

3.  [Estilos de programa√ß√£o](#estilo_de_programacao)

    -   Scripts

    -   Regras
:::

::: {.column width="50%" style="font-size: 40px"}
4.  [Pacotes](#pacotes)

    -   Instala√ß√£o e uso

    -   Fun√ß√µes

5.  [Ajuda em R](#ajuda-em-r)

    -   Interna

    -   Externa

6.  [Iniciar sess√£o no R](#iniciar-sessao-no-r)

    -   Comandos b√°sicos

    -   Erros e advert√™ncias
:::
:::

## 

### O que √© R? {#r}

::: incremental
-   R √© uma linguagem de programa√ß√£o interpretada de c√≥digo aberto. N√£o √© compilada e √© executada passo a passo por um programa que interpreta os resultados.

-   R √© uma linguagem de progama√ß√£o orientada a manipula√ß√£o de dados, an√°lise estat√≠stica e visualiza√ß√£o gr√°fica dos dados.
:::

## 

#### Hist√≥ria do R

::: incremental
-   Em 1993 o R foi criado como um dialeto da linguagem S desenvolvida por [John Chambers](https://www.r-bloggers.com/2014/01/john-chambers-recounts-the-history-of-s-and-r/) e colaboradores.

-   Os nomes importantes nesta hist√≥ria s√£o muitos, mas os principais s√£o: [Robert Gentleman](https://en.wikipedia.org/wiki/Robert_Gentleman/statistician) e [Ross Ihaka](https://www.stat.auckland.ac.nz/~ihaka/). A hist√≥ria do R pode ser vista [aqui](https://cran.r-project.org/doc/html/interface98-paper/paper_2.html).

-   Em 1995, [Martin M√§chler](https://people.math.ethz.ch/~maechler/) deu uma contribui√ß√£o importante ao convencer Ross e Robert a usar a Licen√ßa P√∫blica Geral [GNU](https://gnu.org/licenses/gpl-3.0.html) (General Public Licenses) para tornar o R um software livre. A vers√£o 1.0.0 do R s√≥ foi lan√ßada em fevereiro de 2000.\
:::

## 

#### Por que Usar R? {#sec-porque-usar-r}

Algumas das muitas raz√µes:

::: {.incremental style="line-height: 1.8"}
1.  √â gratuito

2.  Funciona em m√∫ltiplas plataformas (Windows, MAC, Linux)

3.  Permite a replicabilidade dos procedimentos

4.  Disp√µe de modernas t√©cnicas estat√≠sticas

5.  Est√° em constante desenvolvimento

6.  √â uma ferramenta poderosa para cria√ß√£o de gr√°ficos

7.  Tem integra√ß√£o com outras linguagens: LATEX, C++, Python, Julia, Stan...
:::

## 

::: {#pq_R style="color: blue; fonte-size: 50px"}
::: {style="color: black; font-size: 50px; text-align: center;"}
\
\

E uma raz√£o fundamental:\
\
Conta com uma comunidade muito ativa.

\
\
:::
:::

::: {#razao_R style="font-size: 50px; text-align: center;"}
"When you talk about choosing programming languages, I always say you shouldn't pick them based on technical merits, but rather pick them based on the community."
:::

::: {style="font-size: 50px; text-align: right;"}
[Hadley Wickham](https://www.r-bloggers.com/2018/08/advice-to-young-and-old-programmers-a-conversation-with-hadley-wickham/)
:::

## 

#### Por que programar?

::: {style="font-size: 50px; line-height: 200%;"}
-   Melhora a organiza√ß√£o das ideias.
-   Aumenta a criatividade para resolver problemas.
-   Torna a solu√ß√£o dos problemas mais eficiente.
:::

## 

#### CRAN {#sec-informa√ß√£o-sobre-r-e-o-cran}

CRAN (The Comprehensive R Archive Network) √© uma rede ftp (File Transfer Protocol) que contem toda a informa√ß√£o sobre R e seus pacotes.\
Na p√°gina (<https://cran.r-project.org>) se encontram todas as informa√ß√µes nesess√°rias para iniciar-se em R:

::: {#info_r style="margin-left: 10%;"}
-   [Manuais principais](https://cran.r-project.org/manuals.html)

-   [Pol√≠ticas do reposit√≥rio](https://cran.r-project.org/web/packages/policies.html)

-   [Livros relacionados com S e R em v√°rios idiomas](https://cran.r-project.org/other-docs.html)

-   [Jornal do R](https://journal.r-project.org/)
:::

## 

#### Outros locais de informa√ß√£o

Informa√ß√µes relevantes sobre R podem ser encontradas em:

::: {#other_info style="margin-left: 10%"}
-   [Journal of Statistical Software](https://www.jstatsoft.org/index)

-   [Tend√™ncias atuais no GitHub](https://github.com/trending/r?since=monthly)

-   [R-blogger](https://www.r-bloggers.com/)
:::

## 

### Instala√ß√£o e estrutura {#instalacao-e-estrutura}

1.  Download

-   Download e instru√ß√µes de instala√ß√£o do R: <https://cran.r-project.org/>\
-   Download e instru√ß√µes de instala√ß√£o do RStudio: <https://posit.co/download/rstudio-desktop/>

2.  Atualiza√ß√£o do R

```{r instal_windows, eval = FALSE, include=TRUE, echo=TRUE}
install.packages("installr")
installr::updateR()
```

## 

#### R online

-   No site rdrr.io tem o servi√ßo [snippets](https://rdrr.io/snippets/) onde os c√≥digos do R podem ser executados na internet, o limitante √© que n√£o se pode instalar novos pacotes l√° e n√£o h√° um modo privativo e seguro.

-   O [RStudio Cloud](https://posit.cloud/plans/free) √© um servi√ßo gratuito oferecido pelo RStudio que permite aos usu√°rios usar o R o RStudio on-line e colaborar em projetos com outros usu√°rios atrav√©s do site do RStudio Cloud. O limitante √© que se for usar mais de 24h por m√™s passa a ser pago.

## 

#### Sess√µes do R

+--------------------------------------------------------------------------------------------+
| ### ![](images/iconR.jpg){fig-align="left" width="100"} Sess√£o do RGui {style="fig-align"} |
+--------------------------------------------------------------------------------------------+

![](images/Rgui.PNG){fig-align="center"}

## 

+-----------------------------------------------------------------------------------------------------+
| ### ![](images/iconRStudio.jpg){fig-align="left" width="100"} Sess√£o do RStudio {style="fig-align"} |
+-----------------------------------------------------------------------------------------------------+

![](images/rstudio.PNG){fig-align="center" width="1200"}

## 

#### Mensagem inicial da sess√£o do R {style="font-size: 50px;"}

```{r mensagem R, eval = FALSE, include=TRUE, echo=TRUE, `code-line-numbers`="1-3|5-7|9-11|13-15"}

R version 4.3.2 (2023-10-31 ucrt) -- "Eye Holes"
Copyright (C) 2023 The R Foundation for Statistical Computing
Platform: x86_64-w64-mingw32/x64 (64-bit)

R √© um software livre e vem sem GARANTIA ALGUMA.
Voc√™ pode redistribu√≠-lo sob certas circunst√¢ncias.
Digite 'license()' ou 'licence()' para detalhes de distribui√ß√£o.

R √© um projeto colaborativo com muitos contribuidores.
Digite 'contributors()' para obter mais informa√ß√µes e
'citation()' para saber como citar o R ou pacotes do R em publica√ß√µes.

Digite 'demo()' para demonstra√ß√µes, 'help()' para o sistema on-line de ajuda,
ou 'help.start()' para abrir o sistema de ajuda em HTML no seu navegador.
Digite 'q()' para sair do R.

```

## 

#### Pain√©is do RStudio

```{r, echo=FALSE, eval=TRUE}
painel <- c("Editor", "Console", "Run", "Enviroment", "History", 
  "Terminal", "Files", "Plot", "Packages", "Help")
descricao <- c("Local para desenvolvimento de scripts", "Imprime na tela as senten√ßas executadas a partir do editor ou diretamente no console", "Executa uma instru√ß√£o do editor (Ctrl+Enter) onde est√° o cursor ou o que est√° selecionado", "Lista todos os objetos gerados em cada sess√£o", "Hist√≥rico de execu√ß√£o", "Um terminal para conectar ao Git, por exemplo, entre outras coisas", "Arquivos (dados, script) podem ser pesquisados neste painel", "Imprime os gr√°ficos", "√â um gerenciador de pacotes instalados", "Ajuda r√°pida")

df <- data.frame(Painel = painel, Descri√ß√£o = descricao)
kableExtra::kable(df, booktabs = TRUE) %>%
  kableExtra::kable_styling(font_size = 30)
```

## 

#### Locais com instru√ß√µes e atalhos sobre a configura√ß√£o e uso

-   [Customizar o RStudio](https://support.posit.co/hc/en-us/articles/200549016-Customizing-the-RStudio-IDE)

-   [Comandos do hist√≥rico](https://support.posit.co/hc/en-us/articles/200526217-Command-History-in-the-RStudio-IDE)\

-   [Atalhos](https://support.posit.co/hc/en-us/articles/200404846-Working-in-the-Console-in-the-RStudio-IDE) para trabalhar no console.

\

## 

#### Verificando as vers√µes

Ao iniciar o R, aparecer√° no console a vers√£o que est√° em execu√ß√£o e o nome.\

\

```{r, echo=TRUE, eval = FALSE, `code-line-numbers`="1|3-4|6-7|9|11-12|14"}
R.Version() # Informa√ß√£o detalhada de vers√£o do R

R.Version()$version.string # N√∫mero e data da vers√£o
## [1] "R version 4.3.2 (2023-10-31 ucrt)"

R.Version()$nickname # Nome da vers√£o
## [1] "Eye Holes"

sessionInfo() # Informa√ß√£o detalhada da sess√£o atual

RStudio.Version()$version # Vers√£o do RStudio
## [1] ‚Äò2023.12.1.402‚Äô

Sys.info() ## Informa√ß√£o do sistema operacional

```

## 

#### Import√¢ncia do uso de scripts ou c√≥digos

Um script √© um arquivo de texto que cont√©m um conjunto de comandos ou instru√ß√µes. Esses comandos e instru√ß√µes s√£o executados sequencialmente no R. O script permite automatizar as tarefas e registrar todo o m√©todo de processamento.\

**Importante**:

::: incremental
-   O nome do arquivo de script deve ser suficientemente claro para refletir o conte√∫do e encontr√°-lo facilmente. Se poss√≠vel deve ser curto e evitar o uso de `"."` .

-   √â muito importante documentar as opera√ß√µes ou fun√ß√µes utilizadas no script, para poder replicar com facilidade o trabalho. Os coment√°rios devem come√ßar com `"#"`.
:::

## 

#### Coment√°rios nos scripts

```{r, echo = TRUE, results='hide'}
X <- c(1, 8, 19)
# O objeto 'X' √© um vetor de tr√™s n√∫meros. 
# Isto √© um coment√°rio
```

## 

### Estilos de programa√ß√£o {#estilo_de_programacao}

Existem diferentes maneiras de programar. √â importante ser cuidadoso na maneira de escrever seu c√≥digo para que seja f√°cil replicar e ler o c√≥digo.\

```{r, eval=FALSE, echo=TRUE, `code-line-numbers`="2-2|4-8"}
## Mal escrito
media<-function (x){n<-length(x);sum(x)/n}

## Bem escrito
media <- function(x) {
        n <- length(x)
        sum(x) / n
}

```

## 

#### Guias de estilo de programa√ß√£o

-   O pacote [styler](https://cran.r-project.org/web/packages/styler/index.html) pode ser de grande ajuda

-   Guia de estilo de Hadley [aqui](http://adv-r.had.co.nz/Style.html)

-   Guia de estilo de Google [aqui](https://google.github.io/styleguide/Rguide.html)

## 

### Pacotes {#pacotes}

Um pacote √© constitu√≠do por um conjunto de fun√ß√µes e arquivos de dados, devidamente documentados, que implementam uma ou mais t√©cnicas para tratamento e an√°lise de dados.

#### Instalar

```{r, echo = TRUE, eval=FALSE, `code-line-numbers`="2|5-6"}
## Baixa um pacote do CRAN
install.packages("ggplot2")

## Baixa um pacote do GitHub (vers√£o de desenvolvimento do pacote)
install.packages("devtools")
devtools::install_github("VivianeCFerrari/digeoqR")

```

## 

#### Carregar

```{r, echo = TRUE, eval=FALSE, `code-line-numbers`="1-2|4-5|7-8"}
## Para usar as fun√ß√µes de um pacote j√° instalado usar a fun√ß√£o:
## library(...)

library("digeoqR")
# Voc√™ pode dispensar o uso de aspas

library(digeoqR)
# Sem aspas
```

## 

#### Fun√ß√µes no R

Quase todas as fun√ß√µes do R seguem uma mesma estrutura. Este exemplo mostra uma fun√ß√£o com dois argumentos:\
\

::: {style="font-size: 50px; text-align: center;"}
`nome_da_fun√ß√£o(argumento1 = valor1, argumento2 = valor2)`
:::

## 

#### Executando fun√ß√µes no R

```{r, echo = TRUE, eval = FALSE, `code-line-numbers`="1-2|4-6|8-9|11-12|14-15"}
mean(variable.1)
## Error in mean(variable.1): object 'variable.1' not found

variable.1 <- seq(1, 100, 0.3)
mean(variable1)
## Error in mean(variable1): object 'variable1' not found

mean(variable.1)
## [1] 50.5

sqt(8)
## Error in sqt(8): could not find function "sqt"

sqrt(8)
## [1] 2.828
```

## 

#### Instru√ß√µes de uso das fun√ß√µes

::: incremental
-   Os argumentos de uma fun√ß√£o com valores incorretos podem n√£o ser chamados quando a fun√ß√£o for executada.\
    \
-   Os argumentos na fun√ß√£o tem uma ordem que deve ser seguida caso o usu√°rio optar por n√£o nome√°-los.\
    \
-   Os argumentos podem ser colocados em ordem personalizada mas devem ser nomeados.\
:::

## 

Todas estas op√ß√µes geram o mesmo resultado:\

```{r, echo= TRUE, eval=TRUE}
mean(x = 1:10)
mean(1:10)
mean(x = c(1:10, NA), trim = 0, na.rm = TRUE)
mean(trim = 0, x = c(1:10, NA), na.rm = TRUE)
mean(c(1:10, NA), 0, TRUE)

```

## 

#### Documenta√ß√£o e recursos sobre os pacotes

-   [Lista de pacotes ativos](https://cran.r-project.org/web/packages/available_packages_by_name.html)\
    \
-   [Lista de pacotes por √°rea](https://cran.r-project.org/web/views/)\
    \
-   [Pacotes mais baixados](https://www.r-pkg.org/downloaded)

## 

### Ajuda {#ajuda-em-r}

#### Conseguindo ajuda por si s√≥

```{r, echo=TRUE, eval=FALSE, `code-line-numbers`="1|3|5|7-8|10|12|14-15|17-18|20-21|23|25-26|28-29"}
help(lm) # Comando b√°sico de busca

?lm # idem do anterior

help("+") # Ajuda sobre un operador

help.search("norm") # Busca entre os pacotes instalados as
# fun√ß√µes que contenham o termo "norm"

??norm # idem anterior

apropos("mean") # Lista de fun√ß√µes que contenham o termo "mean"

help(rlm, package="MASS") # Busca a ajuda de uma fun√ß√£o especifica
# de um pacote

RSiteSearch("glm") # Busca os manuais e arquivos de ajuda da web
# R-project

find("mean") # Devolve o pacote o qual pertenece a fun√ß√£o.
# (o pacote deve estar carregado: library())

example(contour) # Executa os exemplos dispon√≠veis da fun√ß√£o

browseVignettes() # Mostra na web as vinhetas dispon√≠veis e o acesso
# a elas. De um pacote: (package="package-name")

vignette(all=TRUE) # Mostra todas as vinhetas dispon√≠veis na tela
#
```

## 

#### Elementos da ficha t√©cnica de uma fun√ß√£o

+--------------+-------------------------------------------------------------------------+
| Name:        | o nome da fun√ß√£o (entre chaves `{}` o pacote ao qual pertence a fun√ß√£o) |
+--------------+-------------------------------------------------------------------------+
| Description: | Breve descri√ß√£o da fun√ß√£o                                               |
+--------------+-------------------------------------------------------------------------+
| Usage:       | Sintaxe da fun√ß√£o                                                       |
+--------------+-------------------------------------------------------------------------+
| Arguments:   | Argumentos                                                              |
+--------------+-------------------------------------------------------------------------+
| Value:       | Valores                                                                 |
+--------------+-------------------------------------------------------------------------+
| References:  | Refer√™ncias                                                             |
+--------------+-------------------------------------------------------------------------+
| See Also:    | Fun√ß√µes relacionadas                                                    |
+--------------+-------------------------------------------------------------------------+
| Examples:    | Exemplos de como se usa a fun√ß√£o                                        |
+--------------+-------------------------------------------------------------------------+

## 

```{=html}
<iframe width="1400" height="800"             src="images/mean.html" title="help example"></iframe>
```
## 

#### Ajuda externa

A comunidade R √© muito ativa, por isso √© muito f√°cil na web encontrar em qualquer motor de busca a solu√ß√£o para os problemas que surgem num fluxo de trabalho.

De maneira geral se destacam estas p√°ginas:

<http://search.r-project.org/>

<https://www.rdocumentation.org/>

<https://rseek.org/>

\<<https://stackoverflow.com/questions/tagged/r>\>

<https://stats.stackexchange.com/questions/tagged/r>

## 

### Iniciar uma sess√£o no R {#iniciar-sessao-no-r}

#### Comandos b√°sicos (I)

```{r, echo=TRUE}
ls() # lista os objetos na mem√≥ria
```

\

```{r, echo=TRUE}
y <- c(1, 5, 9) # cria um objeto que contem 3 n√∫meros

y
```

## 

```{r, echo=TRUE, eval=FALSE}
rm(y) # elimina (remove) o objeto 

```

\

```{r, echo=TRUE, eval=TRUE}
objects() # idem ls()

```

\

```{r, echo=TRUE}
# elimina todos os objetos da sess√£o
rm(list=ls(all=TRUE)) 

```

## 

#### Alguns comandos b√°sicos (II)

```{r, echo=TRUE, eval=FALSE, `code-line-numbers`="1|3|5|7|9"}
setwd() # establece diret√≥rio de trabalho

getwd() # devolve o caminho atual

dir() # lista os arquivos no diret√≥rio

list.files() # idem anterior

dir.create() # cria um diret√≥rio
```

## 

##### Exemplos

```{r, eval=FALSE, echo=TRUE, `code-line-numbers`="1-2|4-5|7|9|11|13-14"}
# Op√ß√£o 1
setwd("C:/Users/usuario/Desktop/Curso_R")

# Op√ß√£o 2
directorio1 <- "C:/Users/usuario/Desktop/Curso_R"

setwd(directorio1)

dir.create("../Curso_R/Plots")

directorio2 <- "../Curso_R/Plots"

setwd(directorio2)

```

## 

#### `options()`

Esta fun√ß√£o permite modificar diversas op√ß√µes sobre a forma como R calcula e exibe resultados.

```{r, echo=TRUE, eval=TRUE}
names(options())
```

## 

#### `options()`

argumento `digits`\

Descri√ß√£o: N√∫mero de digitos significativos a serem impressos\

```{r, echo=TRUE, eval=FALSE, `code-line-numbers`="1-2|4-5"}
100/654
## [1] 0.1529052

options(digits = 4)
100/654
## [1] 0.1529
```

## 

#### `options()`

Argumento: `width`\
Descri√ß√£o: Lagura do texto de sa√≠da\

```{r, echo=TRUE, eval=FALSE, `code-line-numbers`="1-3|5-9"}
set.seed(1234)
rnorm(8)
## [1] -1.2071  0.2774  1.0844 -2.3457  0.4291  0.5061 -0.5747 -0.5466

options(width = 40)
set.seed(1234)
rnorm(8)
## [1] -1.2071  0.2774  1.0844 -2.3457
## [5]  0.4291  0.5061 -0.5747 -0.5466
```

## 

#### Erros e advert√™ncias em R

**Importante:**

::: incremental
\

-   Quando aparece uma mensagem de erro ou de alerta √© preciso investigar!\

\

-   A principal diferen√ßa entre um erro e um aviso √© que o erro n√£o produz nenhum resultado, enquanto um aviso o faz.\
:::

## 

#### C√≥digo incompleto

```{r, echo=TRUE, eval=FALSE}
> objeto.1 <- seq(1, 30, 0.5)
> plot(objeto.1
+
+ )
>
```

::: {.incremental style="border:2px solid red;"}
-   Em R o sinal "\>" no painel de console significa que o int√©rprete est√° pronto para receber ordens.

-   Se ap√≥s dar uma ordem aparecer o sinal "+", isso indica que √© uma ordem incompleta. No exemplo acima falta fechar o par√™ntese da fun√ß√£o `plot()`.

-   Se teclar enter com uma fun√ß√£o incompleta vai aparecer novamente o sinal "+", para sair tecle `esc`
:::

## 

#### Dicas para o aprendizado do R

\
Dois conselhos do [Hadley Wickham](http://adv-r.had.co.nz/Introduction.html) para aprender e melhorar a programa√ß√£o em R:\
\

::: {.incremental style="padding:30px;border:2px solid red;"}
1.  Leia c√≥digo fonte. Busque os pacotes ou as fun√ß√µes que voc√™ usa com mais frequ√™ncia e veja como est√£o escritas.\
    \
2.  Adote uma mentalidade cient√≠fica. Se n√£o compreender como funciona algo, desenvolva uma hip√≥tese, desenhe alguns experimentos, execute-os e registre seus resultados.\
:::

## 

### Refer√™ncias extras {#sec-refer√™ncias}

::: incremental
-   The R Foundation \[homepage on the Internet\]. Vienna, Austria: R Foundation for Statistical Computing. The R Project for Statistical Computing. Available from: [¬ª https://www.r-project.org](https://www.r-project.org/)

-   Grolemund G. Hands-On Programming with R \[monograph on the Internet\]. Sebastopol, CA: O‚ÄôReilly Media; 2014. Available from: [¬ª https://rstudio-education.github.io/hopr](https://rstudio-education.github.io/hopr)

-   [Introdu√ß√£o √† an√°lise de dados com R](https://datawithr.com/)

-   [Data Skills](https://psyteachr.github.io/data-skills-v1/index.html)

-   [R for Data Science](https://r4ds.had.co.nz/)

-   [R for Excel Users](https://rstudio-conf-2020.github.io/r-for-excel/)
:::

## 2. Uso do R no levantamento geoqu√≠mico

::: incremental
-   Etapa I - Planejamento das esta√ß√µes de coleta\
    \
-   Etapa II - Organiza√ß√£o dos dados do Levantamento Geoqu√≠mico\
    \
-   Etapa III - Avalia√ß√£o dos dados anal√≠ticos\
    \
-   Etapa IV - An√°lise explorat√≥ria dos dados ![](images/em_contrucao.png){width="59"}
:::

## 

### Etapa I Planejamento de esta√ß√µes

::: incremental
-   [Trabalhando com fei√ß√µes espaciais](#trabalhando-com-fei√ß√µes-espaciais)\
-   [Importando a imagem SRTM](#importando-a-imagem-srtm)\
-   [Planejando as esta√ß√µes de coleta](#planejando-as-esta√ß√µes-de-coleta)\
-   [Modelagem das bacias e valida√ß√£o das esta√ß√µes planejadas](#modelagem-das-bacias-e-valida√ß√£o-das-esta√ß√µes-planejadas)\
:::

## 

#### Trabalhando com fei√ß√µes espaciais {#trabalhando-com-fei√ß√µes-espaciais}

```{r var1, echo=FALSE}
rios <- "rios_ibge.shp"
massa_dagua <- "massa_dagua.shp"
area_urbana <- "area_urbana.shp"
limite <- "carta_100M.shp"
limite_srtm <- "area_srtm.shp"
dir_in <- "inputs/campo/"
bacia_minima <- 4
bacia_maxima <- 25
snap_dist <- "0.02"
threshold <- 250
min_length <- "0.02"
max_ordem <- 3
wbt_wd <- "outputs/modelo/"
EPSG <- 4326
dir_out <- "outputs/"
tipo_base <- 1
base_campo <- "fcampo"
dir_os <- "inputs/os/" 
```

**Descri√ß√£o**: Converte as bases de entrada em uma lista de dados para serem carregadas nas fun√ß√µes modela_bacias e gera esta√ß√µes.\
\

```{r feicoes_model, results='hide'}
bases_model <-
  digeoqR::gera_bases_model(dir_in, 
                            limite,
                            limite_srtm, 
                            area_urbana,
                            rios,
                            massa_dagua)
```

## 

#### Importando a imagem SRTM {#importando-a-imagem-srtm}

```{r, echo=FALSE, eval=TRUE}
dir_in <- "inputs/campo/"
limite_srtm <- "area_srtm.shp"
dir_out <- "outputs/"
EPSG <- 4326
z <- 11
```

**Descri√ß√£o**: Recupera dados de eleva√ß√£o do terreno da [Amazon Web Services Terrain Tile](https://registry.opendata.aws/terrain-tiles). Para mais detalhes visite o [reposit√≥rio](https://github.com/jhollist/elevatr)\
\

```{r srtm, message = FALSE, results='hide'}
dem <- digeoqR::prepara_dem(dir_in,
                            limite_srtm,
                            dir_out,
                            EPSG,
                            z)
```

## 

#### Raster com dados de eleva√ß√£o (em metros)

```{r, eval=TRUE, echo=FALSE}
plot(dem, main = "", col=topo.colors(300))
```

## 

#### Planejando as esta√ß√µes de coleta {#planejando-as-esta√ß√µes-de-coleta}

**Descri√ß√£o**: Desenvolvido para automatizar o processo de escolha do locais de amostragem que devem ser a 100 m acima dos pontos de conflu√™ncia dos rios. Tamb√©m s√£o exclu√≠das esta√ß√µes em √°reas urbanas e em massa d'√°gua. Todos os arquivos devem ser no formato shapefile.\
\

```{r plan, results='hide'}
 gera_est <- 
  digeoqR::gera_estacoes(dem, 
                        dir_out, 
                        bases_model, 
                        EPSG, 
                        threshold, 
                        min_length, 
                        max_ordem, 
                        wbt_wd) 
```

## 

#### Mapa das esta√ß√µes planejadas

```{r mapa_est_plan, echo=FALSE}
plot(gera_est$mapa)
```

## 

#### Modelagem das bacias e valida√ß√£o das esta√ß√µes planejadas {#modelagem-das-bacias-e-valida√ß√£o-das-esta√ß√µes-planejadas}

```{r, echo=FALSE, eval=TRUE}
fase <- 1
classe_am <- 2
```

**Descri√ß√£o**: A partir da imagem SRTM, rios, massa d'√°gua √© gerado um modelo de drenagem. A densidade de drenagem √© dada pelo valor de threshold, quanto maior este valor, menor a densidade dos cursos dos rios. Ap√≥s isto s√£o geradas as bacias de cada esta√ß√£o de coleta planejada.\
\

```{r model_bacias_plan, results='hide'}
modela_bacias_plan <-
  digeoqR::modela_bacias(fase, 
                         EPSG, 
                         dem, 
                         bases_model, 
                         gera_est, 
                         ex_campo, 
                         classe_am, 
                         bacia_minima, 
                         bacia_maxima, 
                         threshold, 
                         snap_dist, 
                         min_length, 
                         max_ordem, 
                         dir_out,
                         wbt_wd)

```

## 

#### Mapa de planejamento validado {#mapa-de-planejamento_validado}

```{r plan_mapa, echo=FALSE}
plot(modela_bacias_plan$`mapa plan`)
```

## 

### Etapa II Organiza√ß√£o dos dados do Levantamento Geoqu√≠mico

::: incremental
-   [Importa√ß√£o dos dados de campo (FCAMPO, SUVEY123, QFIELD)](#importa√ß√£o-dos-dados-de-campo-fcampo-suvey123-qfield)

-   [Modelagem das bacias amostradas](#modelagem-das-bacias-amostradas)

-   [Visualiza√ß√£o do mapa de esta√ß√µes amostradas e bacias](#visualiza√ß√£o-do-mapa-de-esta√ß√µes-amostradas-e-bacias)

-   [Importa√ß√£o dos dados anal√≠ticos](#importa√ß√£o-dos-dados-anal√≠ticos)

    -   Sedimento de corrente

    -   Concentrado de bateia

-   [Organiza√ß√£o os dados anal√≠ticos](#organiza√ß√£o-dos_dados_anal√≠ticos)

-   [Enriquecimento as bases com fei√ß√µes espaciais (geologia)](#enriquecimento-das-bases-com-fei√ß√µes-espaciais-geologia)
:::

## 

#### Importa√ß√£o dos dados de campo (FCAMPO, SUVEY123, QFIELD) {#importa√ß√£o-dos-dados-de-campo-fcampo-suvey123-qfield}

**Descri√ß√£o**: Uma base de dados √© preparada com as informa√ß√µes da localiza√ß√£o das amostras e os nomes de campo e laborat√≥rio. Usa as planilhas de OS (Ordem de Servi√ßo) para recuperar a rela√ß√£o n√∫mero de campo e n√∫mero de laborat√≥rio.\
\

```{r dados_campo, results='hide'}
ex_campo <- 
  digeoqR::extrai_dados_campo(tipo_base, 
                              dir_in, 
                              base_campo,
                              dir_os,
                              EPSG,
                              dir_out)
```

## 

#### Modelagem das bacias amostradas {#modelagem-das-bacias-amostradas}

-   Sedimento de corrente\
-   Concentrado de bateia\
    \
    **Descri√ß√£o**: A partir da imagem SRTM, rios, massa d'√°gua √© gerado um modelo de drenagem. A densidade de drenagem √© dada pelo valor de threshold, quanto maior este valor, menor a densidade dos cursos dos rios. Ap√≥s isto s√£o geradas as bacias de cada esta√ß√£o de coleta.

## 

##### Sedimento de corrente

```{r, echo=FALSE, eval=TRUE}
fase <- 2
classe_am <- 2
```

```{r sed_cor}
modela_bacias_sc <-
  digeoqR::modela_bacias(fase, 
                         EPSG, 
                         dem, 
                         bases_model, 
                         gera_est, 
                         ex_campo, 
                         classe_am, 
                         bacia_minima, 
                         bacia_maxima, 
                         threshold, 
                         snap_dist, 
                         min_length, 
                         max_ordem, 
                         dir_out, 
                         wbt_wd)
```

## 

##### Concentrado de bateia

```{r, echo=FALSE, eval=TRUE}
fase <- 2
classe_am <- 1
```

```{r conc_bat}
modela_bacias_cb <-
  digeoqR::modela_bacias(fase, 
                         EPSG, 
                         dem, 
                         bases_model, 
                         gera_est, 
                         ex_campo, 
                         classe_am, 
                         bacia_minima, 
                         bacia_maxima, 
                         threshold, 
                         snap_dist, 
                         min_length, 
                         max_ordem, 
                         dir_out, 
                         wbt_wd)
```

## 

#### Visualiza√ß√£o do mapa de esta√ß√µes amostradas e bacias {#visualiza√ß√£o-do-mapa-de-esta√ß√µes-amostradas-e-bacias}

-   Sedimento de corrente\
-   Concentrado de bateia

## 

##### Sedimento de corrente

```{r mapa_am_sc, echo=FALSE}
plot(modela_bacias_sc$`mapa amostragem`)
```

## 

##### Concentrado de bateia

```{r mapa_am_cb, echo=FALSE}
plot(modela_bacias_cb$`mapa amostragem`)
```

## 

#### Importa√ß√£o dos dados anal√≠ticos {#importa√ß√£o-dos-dados-anal√≠ticos}

Nessa rotina os dados dos boletins s√£o lidos e arrumados em dois formatos:\
- dados brutos (sem substitui√ß√£o dos qualificadores)\
- dados transformados (substitui√ß√£o \<LD por 0,5\*LD)\

## 

##### Sedimento de corrente

**Descri√ß√£o** Esta fun√ß√£o l√™ os boletins csv e extrai as informa√ß√µes na forma de tabelas que s√£o gravadas no diret√≥rio de sa√≠da .Retorna uma lista com todos os dados do boletim: resultados anal√≠ticos, condi√ß√µes anal√≠ticas, QA/QC, requisi√ß√£o das an√°lises e prepara√ß√£o das amostras.\
\

```{r, echo=FALSE, eval=TRUE}
dir_bol <- "inputs/quimica/S/"; analise <- 2; 
dir_ucc <- "inputs/quimica/"; ref_ucc <- "ucc.csv";
classe_am <- 2

```

```{r analises_sc, results='hide'}
quimica <- 
  digeoqR::le_boletim_quimica(classe_am,
                              dir_bol,
                              dir_ucc,
                              ref_ucc)
```

## 

##### Concentrado de bateia

```{r, echo=FALSE, eval=TRUE}
dir_bol <- "inputs/mineral/B/"

```

**Descri√ß√£o**: L√™ boletins de an√°lises mineralom√©tricas. Retorna uma lista com todos os dados do boletim: resultados anal√≠ticos, condi√ß√µes anal√≠ticas, requisi√ß√£o das an√°lises, prepara√ß√£o das amostras, separa√ß√£o gravi-magn√©tica.

```{r analises_cb, results='hide'}
mineral <- 
  digeoqR::le_boletim_mineral(dir_bol)
```

## 

#### Organiza√ß√£o dos dados anal√≠ticos {#organiza√ß√£o-dos_dados_anal√≠ticos}

##### Sedimento de corrente

```{r, echo=FALSE, eval=TRUE}
dir_bol <- "inputs/quimica/S/"
analise <- 2
classe_am <- 2

```

**Descri√ß√£o**: Recupera e une os dados dos boletins anal√≠ticos e os dados de campo da base de dados fcampo. Os boletins anal√≠ticos devem estar no formato .csv e com layout modelo da GEOSOL do ano 2022 ou posterior.\
\

```{r base_sc, results='hide', message=FALSE}
base_sc <- 
  digeoqR::prepara_bases(dir_bol, 
                         classe_am, 
                         analise,
                         quimica, 
                         mineral, 
                         ex_campo)
```

## 

###### Base preparada - Sedimento de corrente

```{r tab_base_sc, echo=FALSE}
dados_sc <- base_sc[["dados brutos"]]
rmarkdown::paged_table(dados_sc, options = list(rows.print = 9, cols.print = 5))
```

## 

##### Concentrado de bateia

```{r, echo=FALSE, eval=TRUE}
dir_bol <- "inputs/mineral/B/"
analise <- 1
classe_am <- 1
```

**Descri√ß√£o**: Recupera e une os dados dos boletins anal√≠ticos e os dados de campo da base de dados fcampo. Os boletins anal√≠ticos devem estar no formato .csv e com layout modelo da GEOSOL do ano 2022 ou posterior.\
\

```{r base_cb, results='hide', message=FALSE}
base_cb <- 
  digeoqR::prepara_bases(dir_bol, 
                         classe_am, 
                         analise,
                         quimica, 
                         mineral, 
                         ex_campo)
```

## 

###### Base preparada - Concentrado de bateia

```{r tab_base_cb, echo=FALSE}
dados_cb <- base_cb[["dados brutos"]]
rmarkdown::paged_table(dados_cb, options = list(rows.print = 9, cols.print = 5))
```

## 

#### Enriquecimento das bases com fei√ß√µes espaciais (geologia) {#enriquecimento-das-bases-com-fei√ß√µes-espaciais-geologia}

::: incremental
\

-   Extrai dados xml cores da layer (QGIS)\
-   Visualiza cores das unidades geradas\
-   Prepara recorte da geologia e estilo de cores\
-   Prepara legenda da geologia\
-   Mapa geol√≥gico simplificado\
-   Faz a intersec√ß√£o entre bacias e geologia
:::

## 

##### Extrai dados xml cores da layer (QGIS)

**Descri√ß√£o**: Extrai dados da legenda de um arquivo de estilo xml. No QGIS use a ferramenta Create style database from project para gerar o XML, da fei√ß√£o pretendida, aqui usei usei o do mapa geol√≥gico do Brasil ao milhon√©simo de 2014 do SGB-CPRM.\
\

```{r mapas_base}

legenda_geol <- 
  digeoqR::resgata_legenda_xml()

```

## 

##### Visualiza cores das unidades geradas

```{r echo=FALSE}
rmarkdown::paged_table(head(legenda_geol[,-1]))
```

## 

##### Prepara o recorte da geologia e estilo de cores

```{r, echo=FALSE, eval=TRUE}
feicao_in <- "geologia_br"; feicao_out <- "geologia_area";
dir_in <- "inputs/campo/"; area <- "area_srtm"
chave <- "RANGE"
```

**Descri√ß√£o**: Ferramenta que recorta a shape de uma fei√ß√£o (geologia, solo...) pelo limite da √°rea. Usei o mapa geol√≥gico do Brasil ao milhon√©simo do SGB.\
\

```{r recorte_geol, results='hide'}
geologia <- 
  digeoqR::recorta_feicao_area(dir_in, 
                               dir_out, 
                               area, 
                               feicao_in,
                               feicao_out, 
                               chave)
```

## 

##### Prepara a legenda da geologia

**Descri√ß√£o**: Este processamento usa a shape e xml do mapa das unidades litoestratigr√°ficas do Brasil (2014) obtidos do GEOSGB (SGB-CPRM).\
\

```{r leg_geo, results='hide'}
lista_legenda <- 
  digeoqR::prepara_legenda(feicao_rec = geologia, 
                           dir_out, 
                           dir_in, 
                           nome_xml = "geologia")
```

## 

##### Mapa geol√≥gico simplificado

```{r mapa_geol, echo=FALSE}
leg1 <- lista_legenda[[1]]
leg2 <- lista_legenda[[2]]
estacoes <- ex_campo[["esta√ß√µes"]]
estacoes <- estacoes[estacoes$CLASSE == "Sedimento de corrente",]
ggplot2::ggplot() +
  ggplot2::geom_sf(data=geologia, ggplot2::aes(fill = RANGE)) + 
  ggplot2::geom_sf(data=estacoes, color = "black", shape = 1) + 
  ggplot2::scale_fill_manual(values=leg2$RGB, breaks=leg2$SIGLA) +
  ggplot2::theme_minimal()+
  ggspatial::annotation_scale(location = "br", style = "ticks") +
  ggspatial::annotation_north_arrow(location = "bl")

```

## 

##### Faz a intersec√ß√£o entre bacias e geologia

```{r, echo=FALSE, eval=TRUE}
bacias <- modela_bacias_sc[["bacias"]]
estacoes <- base_sc[["dados campo sf"]]
feicao_rec <- geologia
nome_xml <- "geologia"
classe_am <- 2
tipo_leg <- 2
lista_legenda <- lista_legenda
```

**Decri√ß√£o**: Cada bacia √© recortada pelos pol√≠gonos da geologia. Esta fun√ß√£o est√° configurada para a shape do mapa geol√≥gico ao milhon√©simo 2014 do SGB-CPRM.\
\

```{r inters_bacias, results='hide'}
lito_bacia_sc <-
  digeoqR::intersecta_bacias(dir_in,
                             dir_out, 
                             bases_model,
                             bacias, 
                             feicao_rec,
                             tipo_leg,
                             lista_legenda,
                             estacoes,
                             classe_am, 
                             nome_xml)
   
```

## 

### Etapa III Avalia√ß√£o dos dados anal√≠ticos

-   [An√°lise dos dados censurados √† esquerda](#dados-censurados-a-esquerda)

-   [An√°lise dos valores ausentes](#an√°lise-dos-valores-ausentes)

-   [Testes estat√≠sticos (dados brutos)](#testes-estat√≠sticos)

    -   Normalidade (Shapiro-Wilker e Lillie-Fors\
    -   Comparativo (Wilcolxon n√£o pareado)\

-   [QAQC das duplicatas de campo e replicatas de laborat√≥rio](#qaqc-das-duplicatas-de-campo-e-replicatas-de-laborat√≥rio)

    -   Duplicatas de campo\
    -   Replicatas de laborat√≥rio

-   [Estat√≠stica descritiva](#estat√≠stica-descritiva)

## 

#### An√°lise dos dados censurados √† esquerda {#dados-censurados-a-esquerda}

```{r, echo=FALSE, eval=TRUE}
corte_val = 70
base <- base_sc
```

**Descri√ß√£o**: Filtra os elementos pelo grau de detec√ß√£o.\
\

```{r analise_elem,  results='hide'}
res_val <- 
  digeoqR::validacao_elementos(dir_out, 
                               base, 
                               corte_val)
```

## 

#### Elementos V√°lidos (grau de detec√ß√£o \>70%)

```{r elem_val, echo= FALSE }
elem_val = res_val[[2]]

rmarkdown::paged_table(data.frame(Elementos = elem_val))
```

## 

#### N√∫mero de dados \<LD por analito

```{r n_validos, echo = FALSE}
nmld <- res_val[[1]][, c("elementos", "nneg")]
colnames(nmld) <- c("Analito", "N. <LD")
rmarkdown::paged_table(nmld, 
                       options = list(rows.print = 9))
```

## 

#### An√°lise dos valores ausentes {#an√°lise-dos-valores-ausentes}

```{r ausentes, echo = FALSE}
nmna <- res_val[[1]][, c("elementos", "nna")]
colnames(nmna) <- c("Analito", "N. Ausentes")
rmarkdown::paged_table(nmna,
                       options = list(rows.print = 9))
```

## 

#### Testes estat√≠sticos (dados brutos) {#testes-estat√≠sticos}

```{r, echo=FALSE, eval=TRUE}
lito_bacia <- lito_bacia_sc
leg <- leg2
base <- base_sc
```

**Descri√ß√£o**: Testes de normalidade e de compara√ß√£o das amostras. M√©todo de transforma√ß√£o dos dados: 1 = sem transforma√ß√£o e 2 = logtransformados\
\

```{r test_brutos, echo=TRUE, results='hide'}
teste_mtd_transf1 <-
  digeoqR::testes_estatisticos(dir_out, 
                               base, 
                               lito_bacia, 
                               mtd_transf = 1, 
                               nbc = 10, 
                               leg, 
                               elem_val )
```

## 

##### Teste Shapiro-Wilker

```{r vis_sw_brutos, echo=FALSE}

teste_sw <- teste_mtd_transf1[['test. norm. Shapiro-Wilk unidades']]
 
rmarkdown::paged_table(teste_sw, 
                       options = list(rows.print = 9, cols.print = 5))
```

## 

##### Teste Lillie-Fors

```{r lf_brutos, echo=FALSE}
teste_lf <- teste_mtd_transf1[["test. norm. Lillie geral"]]
rmarkdown::paged_table(teste_lf, 
                       options = list(rows.print = 9, cols.print = 5))
```

## 

##### Teste Wilcoxon

**Descri√ß√£o**: Visual do Teste Wilcoxon compara as an√°lises de cada elemento agrupados por unidades litol√≥gicas. Apresenta um gr√°fico onde a cor vermelha indica p-value \<0,05.

```{r prep_vis_wilcoxon, echo=TRUE, eval=TRUE, results='hide'}
vis_wilcolxon <- 
  digeoqR::vis_teste_wilcox(dir_out,
                            elem_val,base,
                            lito_bacia, 
                            nbc = 10)
```

## 

###### Visualiza√ßao do teste Wilcoxon do Alum√≠nio

```{r vis_wx_al, echo = FALSE}
gridExtra::grid.arrange(grobs = vis_wilcolxon[c(1,length(vis_wilcolxon))],  
                         ncol = 2,
                         top = grid::textGrob(""),
                        gp=gpar(fontsize=12,font=3))
                        
                        
```

## 

##### QAQC das duplicatas de campo {#qaqc-das-duplicatas-de-campo-e-replicatas-de-laborat√≥rio}

**Descri√ß√£o**: Controle de qualidade anal√≠tico e amostral. Tipos de amostragem: 1 = duplicata de campo 2 = replicata de laborat√≥rio.\
\

```{r, echo=FALSE, eval=TRUE}
base <- base_sc
tipo_am = 1
```

\

```{r qaqc_campo, results='hide'}
qaqc <- digeoqR::qaqc_gq(dir_out, 
                         base, 
                         tipo_am = 1)
```

## 

###### Gr√°fico Thompson-Howard

```{r vis_TH_campo, echo=FALSE}
gridExtra::grid.arrange(grobs=qaqc[["gr√°fico com texto"]]["Al"], ncol = 1)
```

## 

###### Tabela de precis√£o das duplicatas de campo

```{r tab_precisao_campo, echo=FALSE}
table_grid <- gridExtra::tableGrob(qaqc[["df tabela de precis√£o"]], rows = NULL, theme = gridExtra::ttheme_default(base_size = 20))
gridExtra::grid.arrange(table_grid)
```

## 

##### QAQC das replicatas de laborat√≥rio

**Descri√ß√£o**: Controle de qualidade anal√≠tico e amostral. Tipos de amostragem: 1 = duplicata de campo 2 = replicata de laborat√≥rio.\
\

```{r, echo=FALSE, eval=TRUE}
base <- base_sc
tipo_am = 2
```

```{r qaqc_lab, results='hide'}
qaqc <- digeoqR::qaqc_gq(dir_out, 
                         base, 
                         tipo_am = 2)
```

## 

###### Gr√°fico Thompson-Howard

```{r vis_TH_lab, echo=FALSE}
gridExtra::grid.arrange(grobs=qaqc[["gr√°fico com texto"]]["Al"], ncol = 1)
```

## 

###### Tabela de precis√£o das replicatas de laborat√≥rio

```{r tab_precisao_lab, echo=FALSE}
table_grid <- gridExtra::tableGrob(qaqc[["df tabela de precis√£o"]], rows = NULL, theme = gridExtra::ttheme_default(base_size = 20))
gridExtra::grid.arrange(table_grid)
```

## 

#### Estat√≠stica descritiva {#estat√≠stica-descritiva}

##### Geral

```{r, echo=FALSE, eval=TRUE}
rotulo_lito <- lito_bacia_sc[[2]]
base <- base_sc
tipo_proc <- 1
```

**Descri√ß√£o**: Gera planilhas com os principais par√¢metros estat√≠sticos em dois modos de processamento: 1 = Todas amostras e 2 = Agrupadas por unidades.\
\

```{r stat_geral, results='hide'}
tabela_estat_g_sc <- 
  digeoqR::tabela_estatistica(tipo_proc = 1,
                              rotulo_lito, 
                              base,
                              lista_legenda, 
                              dir_out)

```

## 

###### Visualiza√ß√£o do sum√°rio estat√≠stico - Elementos

```{r vis_sum_stat_geral1, echo=FALSE}
stat_transposta_g_sc <- tabela_estat_g_sc[[1]]
colnames(stat_transposta_g_sc) <- stat_transposta_g_sc[2,]
stat_transposta_g_sc <- data.frame(stat_transposta_g_sc)
rmarkdown::paged_table(stat_transposta_g_sc, options = list(rows.print = 9, cols.print = 5))
```

## 

###### Visualiza√ß√£o do sum√°rio estat√≠stico - Par√¢metros

```{r vis_sum_stat_geral2, echo=FALSE}
stat_normal_g_sc <- tabela_estat_g_sc[[2]]
rmarkdown::paged_table(stat_normal_g_sc, options = list(rows.print = 9, cols.print = 5))
```

## 

##### Agrupado

```{r, echo=FALSE, eval=TRUE}
tipo_proc = 2
```

**Descri√ß√£o**: Gera planilhas com os principais par√¢metros estat√≠sticos em dois modos de processamento: 1 = Todas amostras e 2 = Agrupadas por unidades.\
\

```{r stat_unid, results='hide'}
tabela_estat_a_sc <-
  digeoqR::tabela_estatistica(tipo_proc = 2,
                              rotulo_lito,
                              base, 
                              lista_legenda, 
                              dir_out)

```

## 

###### Visualiza√ß√£o do sum√°rio estat√≠stico - Elementos

```{r vis_sum_stat_unid1, echo=FALSE}

stat_normal_a_sc <- tabela_estat_a_sc[[2]]
stat_normal_a_sc <- data.frame(stat_normal_a_sc, check.names = FALSE)
rmarkdown::paged_table(stat_normal_a_sc, options = list(rows.print = 9, cols.print = 5))
```

## 

###### Visualiza√ß√£o do sum√°rio estat√≠stico - Par√¢metros

```{r vis_sum_stat_unid2, echo=FALSE}
stat_transposta_a_sc <- tabela_estat_a_sc[[1]]
colnames(stat_transposta_a_sc) <- stat_transposta_a_sc[2,]
stat_transposta_a_sc <- data.frame(stat_transposta_a_sc, check.names = FALSE)
elementos <- unique(colnames(stat_transposta_a_sc))
elementos <- elementos[!is.na(elementos)]
stat_transposta_a_sc <- stat_transposta_a_sc %>%
 dplyr::select(elementos) 
rmarkdown::paged_table(stat_transposta_a_sc, options = list(rows.print = 9, cols.print = 5))
```

## 

### Etapa IV An√°lise Explorat√≥ria dos dados

-   Classifica√ß√£o de todas as amostras

-   Classifica√ß√£o das amostras agrupadas por unidade geol√≥gica

-   Outras an√°lises em desenvolvimento.

##  {visibility="hidden"}

#### Classifica√ß√£o de todas as amostras

M√©todo de classifica√ß√£o: MAD

```{r mad_tudo, eval = FALSE, echo=TRUE}
cl_mtd_mad <- 
  digeoqR::classifica_metodos(tipo_proc = 1,
                              mtd_class = 1,
                              lito_bacia,
                              elem_val,
                              base,
                              nbc = 10)
```

## 

#### Classifica√ß√£o de todas as amostras

**Descri√ß√£o**: M√©todos de classifica√ß√£o de dados geoqu√≠micos. Tipos de processamento: 1 = geral 2 = por unidades. M√©todos de classifica√ß√£o 1 = MAD, 2 = TIF, 3 = C-A.\
\
M√©todo de classifica√ß√£o: TIF\

```{r tif_tudo, eval = TRUE, echo=TRUE}
cl_mtd_tif <- 
  digeoqR::classifica_metodos(tipo_proc = 1, 
                              mtd_class = 2,
                              lito_bacia, 
                              elem_val, 
                              base, 
                              nbc = 10)
```

##  {visibility="hidden"}

#### Classifica√ß√£o de todas as amostras

M√©todo de classifica√ß√£o: C-A

```{r , eval = FALSE, echo=TRUE}
cl_mtd_ca <- 
  digeoqR::classifica_metodos(tipo_proc = 1, 
                              mtd_class = 3,
                              lito_bacia, 
                              elem_val, 
                              base, 
                              nbc = 10)
```

##  {visibility="hidden"}

#### Classifica√ß√£o das amostras agrupadas por unidade geol√≥gica

M√©todo de classifica√ß√£o: MAD

```{r, eval = FALSE, echo=TRUE}
cl_mtd_mad_un <- 
  digeoqR::classifica_metodos(tipo_proc = 2, 
                              mtd_class = 1,
                              lito_bacia, 
                              elem_val, 
                              base, 
                              nbc = 10)
```

## 

#### Classifica√ß√£o das amostras agrupadas por unidade geol√≥gica

**Descri√ß√£o**: M√©todos de classifica√ß√£o de dados geoqu√≠micos. Tipos de processamento: 1 = geral 2 = por unidades. M√©todos de classifica√ß√£o 1 = MAD, 2 = TIF, 3 = C-A.\
\
M√©todo de classifica√ß√£o: TIF

```{r, eval = TRUE, echo=TRUE}
cl_mtd_tif_un <- 
  digeoqR::classifica_metodos(tipo_proc = 2, 
                              mtd_class = 2,
                              lito_bacia, 
                              elem_val, 
                              base, 
                              nbc = 10)
```

##  {visibility="hidden"}

#### Classifica√ß√£o das amostras agrupadas por unidade geol√≥gica

M√©todo de classifica√ß√£o: C-A

```{r, eval = FALSE, echo=TRUE}
cl_mtd_ca_un <- 
  digeoqR::classifica_metodos(tipo_proc = 2, 
                              mtd_class = 3,
                              lito_bacia, 
                              elem_val, 
                              base, 
                              nbc = 10)
```

## 

##### Tabela de dados classificados - TIF - todas as amostras

```{r, eval=TRUE, echo=FALSE}
rmarkdown::paged_table(head(cl_mtd_tif) )

```

## 

##### Tabela de dados classificados - TIF - por unidades

```{r, eval=TRUE, echo=FALSE}
rmarkdown::paged_table(head(cl_mtd_tif_un))

```

## 

#### Outras an√°lises

Ainda faltam converter para o pacote digeoqR as fun√ß√µes de:

-   Gr√°ficos EDA
-   Mapas
-   Outras an√°lises explorat√≥rias (Cluster, PCA, FA, regress√£o, RF...)

## 3. Fechamento

-   Considera√ß√µes Finais.

## 

-   Qual os pr√≥ximos passos?

## 

-   Feedback dos participantes.

##  {background-color="black" background-image="images/fundo_azul.png"}

\
\


![](images/logoSGB.png){fig-align="center"}

\

::: {style="font-size: 1.5em; text-align: center"}
OBRIGADA
:::

\
\
\
\

![](images/reguaSGB.png){fig-align="center" width="613"}